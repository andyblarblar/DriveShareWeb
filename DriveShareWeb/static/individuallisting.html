<!DOCTYPE html>

<header>
    <title>Listing Page</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/purecss@3.0.0/build/pure-min.css"
          integrity="sha384-X38yfunGUhNzHpBaEBsWLO+A0HDYOQi8ufWDkZ0k9e0eXz/tH3II7uKZ9msv++Ls" crossorigin="anonymous">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="static/styles.css">
</header>

<body>
    <!-- Copy & Paste to Home, Listings, Reservations, etc (But not Login/Signup)-->
    <!-- Top Navbar -->
    <div id="header">
        <div id="nav-boxes" class="pure-g">
            <a class="pure-u-1-3 nav-box" id="assign-box" href="/">
                Home
            </a>
            <a class="pure-u-1-3 nav-box" id="assign-box" href="/searchlistings">
                Search
            </a>
            <a class="pure-u-1-3 nav-box" id="assign-box" href="/mylistings">
                My Listings
            </a>
            <a class="pure-u-1-3 nav-box" id="assign-box" href="/myreservations">
                My Reservations
            </a>
        </div>
        <div id="logout">
            <a id="logout-icon-holder" href="/logout">
                <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 512 512">
                    <path d="M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 192 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l210.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128zM160 96c17.7 0 32-14.3 32-32s-14.3-32-32-32L96 32C43 32 0 75 0 128L0 384c0 53 43 96 96 96l64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0c-17.7 0-32-14.3-32-32l0-256c0-17.7 14.3-32 32-32l64 0z"/>
                </svg>
            </a>
        </div>
    </div>
    <!-- End Navbar -->

    <!-- Begin Page Content -->
    <p>Listing page</p>
</body>

<script>
    // Calls getReviews on page load
    window.onload = function() {
        getReviews();
    }

    // Gets Reviews to display
    async function getReviews(){
        // ######### NEED WAY OF GETTING LISTING ID FROM LISTING PAGE #########
        // I have no idea how to do so, as buttons/search listings are automatically generated
        // Temp value for now.
        let idVar = 1

        // GET reservations json for listing
        let response = await fetch(`/reservation/${idVar}`);
        let allReservations = await response.json();

        // Loop through list of reservations
        for (let i = 0; i < allReservations.length; i++) {
            let obj = allReservations[i];
            let reviewId = obj.id;

            // GET all reviews for specific reservation
            let response = await fetch(`/review/${reviewId}`)
            let review = await response.json();

            for (let j = 0; j < review.length; j++){
                let obj2 = review[j]

                // Temp log review --->>>!!! Eventually should display reviews on page
                console.log(obj2.text)
                console.log(obj2.rating)
            }
        }
    }

</script>