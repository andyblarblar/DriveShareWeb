<header>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/purecss@3.0.0/build/pure-min.css"
          integrity="sha384-X38yfunGUhNzHpBaEBsWLO+A0HDYOQi8ufWDkZ0k9e0eXz/tH3II7uKZ9msv++Ls" crossorigin="anonymous">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="static/styles.css">
</header>

<div id="recover-form-container">
    <form action="/passwordreset" method="post" id="recover-form" class="pure-form pure-form-stacked">
        <fieldset>
            <legend>Recover Account</legend>
            <label for="username">Username:</label>
            <input type="text" name="username" required>
            <label for="new_password">New Password:</label>
            <input type="password" name="new_password" id="passwordText" required>
            <div class="inline">
                <input type="checkbox" onclick="toggleShow()">
                <label>Show Password</label>
            </div>
            <label for="seq1">What is the name of a pet you have owned?:</label>
            <input type="text" name="seq1" required>
            <label for="seq2">What is the name of your parents hometown?:</label>
            <input type="text" name="seq2" required>
            <label for="seq3">What is your favorite programming language?:</label>
            <input type="text" name="seq3" required>
            <input type="submit" name="submit" value="Recover">
        </fieldset>
    </form>
    <a href="/login">Return to login</a>
</div>

<script>
    // Based on signup page Form Submission
    const form = document.getElementById("recover-form")
    form.addEventListener("submit", submitForm)

    // Manual form submission
    function submitForm(e) {
        e.preventDefault()

        fetch(form.action,
            {
                method: "post",
                body: new FormData(form)
            }
        ).then(
            r => {
                // Redirect back to login if successful
                if (!r.ok) {
                    alert("Invalid question or account or new password")
                } else {
                    alert("Password Recovered successfully!")
                    window.location = "/login"
                }
            }
        )
    }

    function toggleShow() {
        var box = document.getElementById("passwordText")
        if (box.type === "password") {
            box.type = "text";
        } else {
            box.type = "password";
        }
    }

</script>